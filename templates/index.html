
<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙˆØªØ§Øª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        .lang-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9em;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            z-index: 1000;
        }
        
        .lang-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            overflow: hidden;
        }
        
        .welcome-screen {
            padding: 60px 40px;
            text-align: center;
        }
        
        .welcome-screen h1 {
            color: #667eea;
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .welcome-screen p {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 40px;
        }
        
        .start-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.2em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .start-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }
        
        .dashboard {
            display: block;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 40px;
        }
        
        .header h2 {
            font-size: 2em;
            margin-bottom: 10px;
        }
        
        .stats {
            display: flex;
            gap: 20px;
            margin-top: 15px;
        }
        
        .stat-box {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 20px;
            border-radius: 10px;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            margin-top: 5px;
        }
        
        .bots-list {
            padding: 40px;
        }
        
        .bot-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-right: 4px solid #667eea;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .bot-card:hover {
            transform: translateX(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .bot-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .bot-name {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
        }
        
        .status-badge {
            background: #10b981;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }
        
        .status-badge.offline {
            background: #ef4444;
        }
        
        .bot-info {
            color: #666;
            font-size: 0.95em;
            line-height: 1.6;
        }
        
        .bot-info span {
            display: inline-block;
            margin-left: 15px;
        }
        
        .no-bots {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }
        
        .no-bots i {
            font-size: 4em;
            margin-bottom: 20px;
        }
        
        .last-update {
            text-align: center;
            padding: 20px;
            color: #999;
            font-size: 0.9em;
            border-top: 1px solid #eee;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <button class="lang-btn" onclick="toggleLanguage()">English</button>
    <div class="container">
        <div class="welcome-screen" id="welcomeScreen">
            <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹</h1>
            <p>Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ</p>
            <button class="start-btn" onclick="startBrowsing()">Ø§Ø¨Ø¯Ø£ ØªØµÙØ­ Ø¨ÙˆØªØ§ØªÙƒ</button>
        </div>
        
        <div class="dashboard hidden" id="dashboard">
            <div class="header">
                <h2>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¨ÙˆØªØ§Øª</h2>
                <div class="stats">
                    <div class="stat-box">
                        <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙˆØªØ§Øª</div>
                        <div class="stat-value" id="totalBots">0</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
                        <div class="stat-value" id="activeBots">0</div>
                    </div>
                </div>
            </div>
            
            <div class="bots-list" id="botsList">
                <div class="no-bots">
                    <div style="font-size: 4em; margin-bottom: 20px;">ğŸ¤–</div>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ù…ØªØµÙ„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</h3>
                    <p>ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                </div>
            </div>
            
            <div class="last-update">
                Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: <span id="lastUpdate">-</span>
            </div>
        </div>
    </div>

    <script>
        let botsData = {};
        let isArabic = true;
        
        const translations = {
            ar: {
                title: 'Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙˆØªØ§Øª',
                welcome: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹',
                subtitle: 'Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ',
                startBtn: 'Ø§Ø¨Ø¯Ø£ ØªØµÙØ­ Ø¨ÙˆØªØ§ØªÙƒ',
                dashboard: 'Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¨ÙˆØªØ§Øª',
                totalBots: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙˆØªØ§Øª',
                activeBots: 'Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ù†Ø´Ø·Ø©',
                noBots: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ù…ØªØµÙ„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹',
                waiting: 'ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...',
                lastUpdate: 'Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:',
                online: 'Ù…ØªØµÙ„',
                offline: 'ØºÙŠØ± Ù…ØªØµÙ„',
                owner: 'Ø§Ù„Ù…Ø§Ù„Ùƒ',
                room: 'Ø§Ù„ØºØ±ÙØ©',
                type: 'Ø§Ù„Ù†ÙˆØ¹',
                lastSeen: 'Ø¢Ø®Ø± Ø¸Ù‡ÙˆØ±',
                langBtn: 'English'
            },
            en: {
                title: 'Bot Monitor',
                welcome: 'Welcome ğŸ‘‹',
                subtitle: 'Your Bot Monitoring System',
                startBtn: 'Start Browsing Bots',
                dashboard: 'Bots Dashboard',
                totalBots: 'Total Bots',
                activeBots: 'Active Bots',
                noBots: 'No connected bots currently',
                waiting: 'Waiting for data...',
                lastUpdate: 'Last update:',
                online: 'Online',
                offline: 'Offline',
                owner: 'Owner',
                room: 'Room',
                type: 'Type',
                lastSeen: 'Last seen',
                langBtn: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©'
            }
        };
        
        function toggleLanguage() {
            isArabic = !isArabic;
            const lang = isArabic ? 'ar' : 'en';
            const t = translations[lang];
            
            document.documentElement.lang = lang;
            document.documentElement.dir = isArabic ? 'rtl' : 'ltr';
            document.title = t.title;
            
            document.querySelector('.lang-btn').textContent = t.langBtn;
            document.querySelector('.welcome-screen h1').textContent = t.welcome;
            document.querySelector('.welcome-screen p').textContent = t.subtitle;
            document.querySelector('.start-btn').textContent = t.startBtn;
            document.querySelector('.header h2').textContent = t.dashboard;
            document.querySelectorAll('.stat-label')[0].textContent = t.totalBots;
            document.querySelectorAll('.stat-label')[1].textContent = t.activeBots;
            document.querySelector('.last-update').innerHTML = t.lastUpdate + ' <span id="lastUpdate">-</span>';
            
            if (Object.keys(botsData).length > 0) {
                renderBots();
            } else {
                document.getElementById('botsList').innerHTML = `
                    <div class="no-bots">
                        <div style="font-size: 4em; margin-bottom: 20px;">ğŸ¤–</div>
                        <h3>${t.noBots}</h3>
                        <p>${t.waiting}</p>
                    </div>
                `;
            }
        }
        
        function startBrowsing() {
            document.getElementById('welcomeScreen').classList.add('hidden');
            document.getElementById('dashboard').classList.remove('hidden');
            loadBots();
            // ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
            setInterval(loadBots, 5000);
        }
        
        async function loadBots() {
            try {
                const response = await fetch('/api/bots');
                const data = await response.json();
                
                console.log('ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', data);
                console.log('Ø¹Ø¯Ø¯ Ø§Ù„Ø¨ÙˆØªØ§Øª:', data.bots ? Object.keys(data.bots).length : 0);
                
                if (data.bots && Object.keys(data.bots).length > 0) {
                    botsData = data.bots;
                    console.log('Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙˆØªØ§Øª Ø§Ù„Ø¢Ù†...');
                    renderBots();
                } else {
                    console.log('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙˆØªØ§Øª Ù„Ù„Ø¹Ø±Ø¶');
                }
                
                updateLastUpdate();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', error);
            }
        }
        
        function renderBots() {
            const lang = isArabic ? 'ar' : 'en';
            const t = translations[lang];
            const botsList = document.getElementById('botsList');
            
            if (!botsData || Object.keys(botsData).length === 0) {
                botsList.innerHTML = `
                    <div class="no-bots">
                        <div style="font-size: 4em; margin-bottom: 20px;">ğŸ¤–</div>
                        <h3>${t.noBots}</h3>
                        <p>${t.waiting}</p>
                    </div>
                `;
                document.getElementById('totalBots').textContent = '0';
                document.getElementById('activeBots').textContent = '0';
                return;
            }
            
            const totalBots = Object.keys(botsData).length;
            let activeBotsCount = 0;
            
            let html = '';
            for (const [botName, botInfo] of Object.entries(botsData)) {
                const isActive = botInfo.status === 'online';
                if (isActive) activeBotsCount++;
                
                const locale = isArabic ? 'ar-EG' : 'en-US';
                
                html += `
                    <div class="bot-card">
                        <div class="bot-header">
                            <div class="bot-name">ğŸ¤– ${botName}</div>
                            <div class="status-badge ${isActive ? '' : 'offline'}">
                                ${isActive ? t.online : t.offline}
                            </div>
                        </div>
                        <div class="bot-info">
                            ${botInfo.owner ? `<span>ğŸ‘¤ ${t.owner}: ${botInfo.owner}</span>` : ''}
                            ${botInfo.room_id ? `<span>ğŸ  ${t.room}: ${botInfo.room_id}</span>` : ''}
                            ${botInfo.device_type ? `<span>ğŸ“± ${t.type}: ${botInfo.device_type}</span>` : ''}
                            ${botInfo.last_seen ? `<span>ğŸ• ${t.lastSeen}: ${new Date(botInfo.last_seen).toLocaleString(locale)}</span>` : ''}
                        </div>
                    </div>
                `;
            }
            
            botsList.innerHTML = html;
            document.getElementById('totalBots').textContent = totalBots;
            document.getElementById('activeBots').textContent = activeBotsCount;
        }
        
        function updateLastUpdate() {
            const now = new Date();
            const locale = isArabic ? 'ar-EG' : 'en-US';
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString(locale);
        }
    </script>
</body>
</html>
